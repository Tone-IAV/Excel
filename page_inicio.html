<section data-app-page="inicio" id="inicioPage" class="space-y-8">
  <!-- AUTH -->
  <section id="authSection" class="space-y-6 max-w-3xl mx-auto">
    <div class="card hidden" id="sessionWarmupCard" role="status" aria-live="polite">
      <div class="flex items-center gap-4">
        <div class="h-12 w-12 rounded-full border-4 border-primary/20 border-t-primary animate-spin" aria-hidden="true"></div>
        <div class="space-y-1">
          <p id="sessionWarmupTitle" class="pill">Preparando ambiente</p>
          <p id="sessionWarmupMessage" class="text-sm text-slate-600 dark:text-slate-300">
            Validando sua sessão e carregando os últimos dados do curso.
          </p>
        </div>
      </div>
    </div>
    <div class="card" id="loginCard">
      <div class="flex flex-wrap items-start justify-between gap-3 mb-4">
        <div>
          <p class="pill">Acesso seguro</p>
          <h2 class="text-2xl font-semibold">Bem-vindo de volta</h2>
          <p class="text-sm text-slate-500">Entre com sua conta para acompanhar o fórum gamificado.</p>
        </div>
        <button type="button" id="toggleSignup" class="btn btn-ghost text-sm">Ainda não tenho cadastro</button>
      </div>
      <div id="loginMsg" class="feedback hidden"></div>
      <form id="loginForm" class="grid gap-4 mt-4">
        <div class="grid gap-2">
          <label for="lEmail" class="text-xs font-semibold uppercase tracking-wide text-slate-500">E-mail</label>
          <input id="lEmail" class="input" placeholder="nome@empresa.com" autocomplete="email" />
        </div>
        <div class="grid gap-2">
          <label for="lPass" class="text-xs font-semibold uppercase tracking-wide text-slate-500">Senha</label>
          <input id="lPass" type="password" class="input" placeholder="Digite sua senha" autocomplete="current-password" />
        </div>
        <div class="flex flex-wrap items-center justify-between gap-2 text-sm text-slate-600">
          <label class="inline-flex items-center gap-2">
            <input id="rememberMe" type="checkbox" class="w-4 h-4 rounded border-slate-300 text-primary focus:ring-primary" />
            <span>Lembrar de mim neste navegador</span>
          </label>
          <span class="text-xs text-slate-400">Sessão expira após 7 dias de inatividade.</span>
        </div>
        <button id="btnLogin" type="submit" class="btn btn-primary">Entrar</button>
      </form>
    </div>

    <div class="card hidden" id="signupCard">
      <div class="flex flex-wrap items-start justify-between gap-3 mb-4">
        <div>
          <p class="pill">Primeiro acesso</p>
          <h2 class="text-2xl font-semibold">Crie sua conta gratuita</h2>
          <p class="text-sm text-slate-500">Preencha os dados abaixo e confirme o cadastro pelo seu e-mail.</p>
        </div>
        <button type="button" id="toggleLogin" class="btn btn-ghost text-sm">Já tenho conta</button>
      </div>
      <div id="signupMsg" class="feedback hidden"></div>
      <div class="grid gap-3">
        <div class="space-y-1">
          <label for="rName" class="text-xs font-semibold uppercase tracking-wide text-slate-500">Nome completo</label>
          <input id="rName" class="input" placeholder="Nome completo" autocomplete="name" />
          <p id="rNameError" class="error-text"></p>
        </div>
        <div class="space-y-1">
          <label for="rEmail" class="text-xs font-semibold uppercase tracking-wide text-slate-500">E-mail corporativo</label>
          <input id="rEmail" class="input" placeholder="nome@empresa.com" title="Utilize um endereço válido (ex.: nome@empresa.com)." autocomplete="email" />
          <p class="hint">Utilize um endereço válido (ex.: nome@empresa.com).</p>
          <p id="rEmailError" class="error-text"></p>
        </div>
        <div class="space-y-1">
          <label for="rPass" class="text-xs font-semibold uppercase tracking-wide text-slate-500">Senha</label>
          <input id="rPass" type="password" class="input" placeholder="Crie uma senha forte" title="Mínimo de 8 caracteres com letras maiúsculas, minúsculas, números e símbolos." autocomplete="new-password" />
          <p class="hint">Mínimo de 8 caracteres com letras maiúsculas, minúsculas, números e símbolos.</p>
          <p id="rPassError" class="error-text"></p>
        </div>
        <div class="hidden-admin space-y-1">
          <label class="text-xs font-semibold uppercase tracking-wide text-slate-500">Código de segurança (somente para Administrador)</label>
          <input id="rAdminCode" class="input" placeholder="(opcional)" />
          <p id="rAdminCodeError" class="error-text"></p>
        </div>
        <button id="btnSignup" class="btn btn-primary" disabled>Criar conta</button>
        <p class="text-xs text-slate-500">Obs.: Administrador só é criado com código válido.</p>
      </div>
    </div>

    <div class="card hidden" id="confirmCard">
      <div class="flex flex-wrap items-start justify-between gap-3 mb-4">
        <div>
          <p class="pill">Confirmação necessária</p>
          <h2 class="text-2xl font-semibold">Verifique seu e-mail</h2>
          <p class="text-sm text-slate-500">Enviamos um código de 6 dígitos para ativar o acesso.</p>
        </div>
        <button type="button" id="confirmBackToLogin" class="btn btn-ghost text-sm">Trocar conta</button>
      </div>
      <div id="confirmMsg" class="feedback hidden"></div>
      <form id="confirmForm" class="grid gap-4 mt-2">
        <div class="grid gap-2">
          <label for="confirmationEmail" class="text-xs font-semibold uppercase tracking-wide text-slate-500">E-mail</label>
          <input id="confirmationEmail" class="input" readonly />
        </div>
        <div class="grid gap-2">
          <label for="confirmationCode" class="text-xs font-semibold uppercase tracking-wide text-slate-500">Código de confirmação</label>
          <input id="confirmationCode" class="input tracking-[0.35em] text-center text-lg" maxlength="6" placeholder="000000" inputmode="numeric" autocomplete="one-time-code" />
        </div>
        <div class="flex flex-wrap items-center justify-between gap-3 text-sm">
          <button type="button" id="btnResendConfirmation" class="btn btn-ghost text-sm">Reenviar código</button>
          <span id="confirmationCountdown" class="text-xs text-slate-400"></span>
        </div>
        <button id="btnConfirmSignup" type="submit" class="btn btn-primary">Confirmar acesso</button>
      </form>
    </div>
  </section>

  <!-- DASHBOARD -->
  <section id="dashSection" class="hidden space-y-6">
    <div id="studentHeroCard" class="card card-transparent space-y-6">
      <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6">
        <div class="space-y-3 flex-1">
          <div class="flex flex-wrap items-center gap-3">
            <span class="pill">Jornada do aluno</span>
            <div class="student-nav" role="tablist" aria-label="Menu da jornada">
              <button type="button" class="student-nav-btn student-nav-btn-active" data-nav-target="home">Início</button>
              <button type="button" class="student-nav-btn" data-nav-target="next-lesson">Próxima aula</button>
              <button type="button" class="student-nav-btn" data-nav-target="achievements-catalog">Conquistas</button>
            </div>
          </div>
          <h2 class="text-2xl font-semibold" id="studentHeroGreeting">Bem-vindo!</h2>
          <p class="text-sm text-slate-600 dark:text-slate-300 leading-relaxed" id="studentNarrative">
            Faça login para acompanhar seu progresso diário.
          </p>
          <div class="flex flex-wrap items-center gap-2 text-xs" id="studentHeroStats"></div>
        </div>
        <div class="w-full max-w-sm lg:max-w-xs bg-primary/10 border border-primary/20 rounded-2xl p-4 text-primary shadow-sm">
          <p class="text-xs uppercase tracking-wide font-semibold opacity-80">Próxima parada</p>
          <p class="text-lg font-bold mt-1" id="nextLessonPreview">Faça login para liberar sua próxima aula.</p>
          <p class="text-xs mt-2 opacity-80" id="nextLessonProgressHint"></p>
        </div>
      </div>
      <div class="space-y-4" data-home-only>
        <div>
          <h3 class="text-sm font-semibold text-slate-600 dark:text-slate-200">Continue avançando</h3>
          <p class="text-sm text-slate-500 dark:text-slate-300" id="studentHeroGuidance">
            Mantenha o ritmo com pequenas ações diárias e abra o próximo módulo quando estiver pronto.
          </p>
          <div class="mt-4 space-y-2 sm:flex sm:items-center sm:gap-3 sm:space-y-0">
            <button type="button" class="btn btn-primary sm:w-auto w-full" data-nav-target="next-lesson">Ir para a próxima aula</button>
            <button type="button" class="btn btn-ghost sm:w-auto w-full" data-nav-target="achievements-catalog">Ver todas as conquistas</button>
          </div>
        </div>
      </div>
    </div>

    <div id="studentHomeWrap" class="grid gap-6 lg:grid-cols-12 auto-rows-max" data-home-only>
      <div class="lg:col-span-8 space-y-6">
        <div class="card card-flat">
          <h3 class="text-lg font-semibold mb-2">Sua evolução</h3>
          <div class="grid sm:grid-cols-3 gap-3">
            <div class="rounded-2xl p-4 bg-primary/10">
              <div class="text-xs uppercase tracking-wide text-primary/70">XP total</div>
            <div id="xpBox" class="text-3xl font-bold text-primary">0</div>
          </div>
          <div class="rounded-2xl p-4 bg-emerald-100">
            <div class="text-xs uppercase tracking-wide text-emerald-700/80">Módulos concluídos</div>
            <div id="doneBox" class="text-3xl font-bold text-emerald-900">0</div>
          </div>
          <div id="levelCard" class="rounded-2xl p-4 bg-amber-100 level-highlight relative overflow-hidden">
            <div class="flex items-start justify-between gap-2">
              <div id="levelLabel" class="level-label text-xs uppercase tracking-wide font-semibold">Nível</div>
              <span id="levelBadge" class="milestone-badge hidden">🏆 Marco!</span>
            </div>
            <div id="lvlBox" class="text-3xl font-bold text-amber-900 mt-1">1</div>
          </div>
        </div>
        <div class="mt-4 space-y-4">
          <div id="nextLevelCard" class="rounded-2xl border border-amber-200/70 bg-amber-50/80 px-4 py-4 dark:border-amber-500/40 dark:bg-amber-500/10 space-y-3">
            <div class="flex flex-wrap items-center justify-between gap-3 text-sm">
              <div class="flex items-center gap-2 font-semibold text-amber-700 dark:text-amber-200">
                <span class="inline-flex h-9 w-9 items-center justify-center rounded-full bg-amber-200/80 text-lg shadow-sm dark:bg-amber-500/30">⚡</span>
                <span id="nextLevelText">Faltam 0 XP para o nível 2</span>
              </div>
              <span id="nextLevelPct" class="text-xs font-semibold text-amber-700/80 dark:text-amber-200/80">0% do nível atual</span>
            </div>
            <div class="h-2.5 rounded-full bg-amber-200/70 dark:bg-amber-500/30 overflow-hidden">
              <div id="nextLevelBar" class="h-full rounded-full bg-amber-500 dark:bg-amber-400" style="width:0%"></div>
            </div>
            <div id="milestoneWrap" class="flex flex-wrap gap-2 text-xs"></div>
          </div>
          <div>
            <div class="flex items-center justify-between text-sm mb-1">
              <span>Progresso nos 24 módulos</span><span id="pctBox">0%</span>
            </div>
            <div class="h-3 rounded-full bg-slate-200 dark:bg-slate-700 overflow-hidden">
              <div id="barBox" class="h-3 bg-primary dark:bg-blue-500" style="width:0%"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="achievementsCard" class="card card-flat">
        <div class="flex flex-wrap items-center justify-between gap-2 mb-3">
          <h3 class="text-lg font-semibold">Conquistas</h3>
          <span id="achievementsSummary" class="text-xs text-slate-500 dark:text-slate-400"></span>
        </div>
        <div id="achievementsLoading" class="text-sm text-slate-500 dark:text-slate-300">Carregando conquistas...</div>
        <div id="achievementsError" class="text-sm text-rose-600 dark:text-rose-300 hidden"></div>
        <div id="achievementsContent" class="space-y-5 hidden">
          <div>
            <div class="flex items-center justify-between text-sm mb-2">
              <span class="font-semibold">Desbloqueadas</span>
              <span class="text-xs text-slate-500 dark:text-slate-400">Celebre suas conquistas recentes</span>
            </div>
            <div id="achievementsUnlocked" class="achievements-scroll"></div>
            <p id="achievementsUnlockedEmpty" class="text-xs text-slate-500 dark:text-slate-300">Faça login para desbloquear suas primeiras conquistas.</p>
          </div>
          <div>
            <div class="flex items-center justify-between text-sm mb-2">
              <span class="font-semibold">Próximas metas</span>
              <span class="text-xs text-slate-500 dark:text-slate-400">Acompanhe o progresso e continue evoluindo</span>
            </div>
            <div id="achievementsUpcoming" class="achievements-grid"></div>
            <p id="achievementsUpcomingEmpty" class="text-xs text-slate-500 dark:text-slate-300">Participe de check-ins e atividades para liberar novas medalhas.</p>
          </div>
        </div>
      </div>

      <div class="card space-y-6">
        <div class="flex flex-wrap items-start justify-between gap-3">
          <h3 class="text-lg font-semibold">Central de materiais</h3>
          <span class="pill" id="embedAdminTag" data-admin-only aria-hidden="true">Modo administrador</span>
        </div>
        <div id="embedAdminControls" class="grid gap-3 hidden" data-admin-only aria-hidden="true">
          <div class="grid gap-2">
            <input id="excelLink" class="input" placeholder="Cole link compartilhado do Excel (OneDrive/SharePoint/Drive)"/>
            <input id="pptLink" class="input" placeholder="Cole link compartilhado do PowerPoint"/>
          </div>
          <div class="grid md:grid-cols-2 gap-3">
            <div class="space-y-2">
              <label class="text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-400" for="resourcesInput">Recursos recomendados</label>
              <textarea id="resourcesInput" class="input min-h-[120px] resize-y" placeholder="Liste cada recurso em uma linha"></textarea>
            </div>
            <div class="space-y-2">
              <label class="text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-400" for="eventsInput">Próximos eventos</label>
              <textarea id="eventsInput" class="input min-h-[120px] resize-y" placeholder="Adicione eventos futuros, um por linha"></textarea>
            </div>
          </div>
          <div class="flex flex-wrap gap-2 justify-end">
            <button id="btnSaveEmbeds" class="btn btn-primary">Salvar</button>
            <button id="btnLoadEmbeds" class="btn btn-ghost">Atualizar</button>
          </div>
        </div>
        <div class="grid xl:grid-cols-2 gap-6">
          <section class="space-y-5">
            <div class="space-y-3">
              <div class="flex items-center justify-between">
                <div>
                  <h4 class="text-sm font-semibold">Planilhas compartilhadas pelo administrador</h4>
                  <p class="text-xs text-slate-500 dark:text-slate-300">Visualize o conteúdo disponibilizado para toda a turma.</p>
                </div>
              </div>
              <div class="aspect-video bg-slate-200 rounded">
                <iframe id="excelFrame"></iframe>
              </div>
              <p id="adminExcelEmpty" class="text-xs text-slate-500">Nenhum material publicado ainda.</p>
              <ul id="adminExcelList" class="space-y-2 text-sm list-none p-0 m-0"></ul>
            </div>
            <div class="space-y-3">
              <div class="flex items-center justify-between">
                <div>
                  <h4 class="text-sm font-semibold">Apresentações publicadas pela coordenação</h4>
                  <p class="text-xs text-slate-500 dark:text-slate-300">Slides oficiais e roteiros estratégicos.</p>
                </div>
              </div>
              <div class="aspect-video bg-slate-200 rounded">
                <iframe id="pptFrame"></iframe>
              </div>
              <p id="adminPptEmpty" class="text-xs text-slate-500">Nenhuma apresentação compartilhada ainda.</p>
              <ul id="adminPptList" class="space-y-2 text-sm list-none p-0 m-0"></ul>
            </div>
          </section>
          <section class="space-y-5">
            <div class="rounded-2xl border border-slate-200 dark:border-slate-700 bg-slate-50/70 dark:bg-slate-800/50 p-4 space-y-5">
              <div class="flex flex-wrap items-start justify-between gap-3">
                <div class="space-y-1">
                  <h4 class="text-sm font-semibold">Meus materiais pessoais</h4>
                  <p class="text-xs text-slate-500 dark:text-slate-300" id="userFolderHint">Arquivos enviados ficam organizados na sua pasta dedicada no Google Drive.</p>
                </div>
                <a id="userFolderLink" class="btn btn-ghost hidden" target="_blank" rel="noopener">Abrir pasta</a>
              </div>
              <section class="space-y-3">
                <div class="flex flex-wrap items-center justify-between gap-3">
                  <div>
                    <h5 class="text-sm font-semibold">Planilhas Excel</h5>
                    <p class="text-xs text-slate-500 dark:text-slate-400">Formatos aceitos: xls, xlsx, xlsm e csv.</p>
                  </div>
                  <button type="button" id="btnUploadExcel" class="btn btn-primary">Enviar Excel</button>
                </div>
                <input id="uploadExcelInput" type="file" class="hidden" accept=".xls,.xlsx,.xlsm,.csv" />
                <p id="userExcelEmpty" class="text-xs text-slate-500">Você ainda não enviou planilhas.</p>
                <ul id="userExcelList" class="space-y-2 text-sm list-none p-0 m-0"></ul>
              </section>
              <section class="space-y-3">
                <div class="flex flex-wrap items-center justify-between gap-3">
                  <div>
                    <h5 class="text-sm font-semibold">Apresentações PowerPoint</h5>
                    <p class="text-xs text-slate-500 dark:text-slate-400">Formatos aceitos: ppt, pptx, pps, ppsx e odp.</p>
                  </div>
                  <button type="button" id="btnUploadPpt" class="btn btn-primary">Enviar PowerPoint</button>
                </div>
                <input id="uploadPptInput" type="file" class="hidden" accept=".ppt,.pptx,.pps,.ppsx,.odp" />
                <p id="userPptEmpty" class="text-xs text-slate-500">Envie suas apresentações para encontrá-las rapidamente aqui.</p>
                <ul id="userPptList" class="space-y-2 text-sm list-none p-0 m-0"></ul>
              </section>
            </div>
          </section>
        </div>
        <div class="grid md:grid-cols-2 gap-4">
          <div>
            <div class="flex items-center justify-between mb-2">
              <h4 class="text-sm font-semibold">Recursos recomendados</h4>
            </div>
            <p id="resourcesEmpty" class="text-xs text-slate-500 hidden">Nenhum recurso cadastrado ainda.</p>
            <ul id="resourcesList" class="space-y-2 text-sm list-none p-0 m-0"></ul>
          </div>
          <div>
            <div class="flex items-center justify-between mb-2">
              <h4 class="text-sm font-semibold">Próximos eventos</h4>
            </div>
            <p id="eventsEmpty" class="text-xs text-slate-500 hidden">Nenhum evento informado no momento.</p>
            <ul id="eventsList" class="space-y-2 text-sm list-none p-0 m-0"></ul>
          </div>
        </div>
      </div>

    </div>

      <div class="lg:col-span-4 space-y-6">
        <div class="card" data-home-only>
          <div class="flex flex-wrap items-start justify-between gap-3 mb-3">
            <div>
              <h3 class="text-lg font-semibold">Missões do dia</h3>
              <p class="text-sm text-slate-500 dark:text-slate-300">Priorize ações rápidas para manter o ritmo da temporada.</p>
            </div>
            <span class="pill">Streak máx. 24</span>
          </div>
          <ul id="dailyMissionList" class="mission-list"></ul>
        </div>

        <div class="card">
          <h3 class="text-lg font-semibold mb-2">Check-in diário</h3>
          <p class="text-sm text-slate-500 mb-2">Ganhe +XP 1x ao dia e avance sua sequência rumo ao bônus de 300 XP.</p>
          <button id="btnCheckin" class="btn btn-primary">Confirmar presença</button>
          <div id="checkinStreakInfo" class="mt-3 text-xs text-slate-500 dark:text-slate-300 leading-relaxed"></div>
          <div id="checkinMsg" class="text-xs text-emerald-600 mt-2"></div>
        </div>

      <div class="card" id="historyCard">
        <div class="flex flex-wrap items-center gap-3 mb-3">
          <h3 class="text-lg font-semibold">Histórico de XP</h3>
          <div id="historyStreakWrap" class="flex flex-wrap items-center gap-2 text-xs hidden">
            <span id="historyStreakCurrent" class="pill"></span>
            <span id="historyStreakBest" class="pill"></span>
          </div>
        </div>
        <div class="flex flex-wrap items-center gap-3 mb-4">
          <div class="inline-flex gap-2 bg-slate-100 dark:bg-slate-800/60 p-1 rounded-full">
            <button type="button" class="history-tab history-tab-active" data-history-tab="checkins">Check-ins</button>
            <button type="button" class="history-tab" data-history-tab="activities">Atividades</button>
          </div>
          <div class="ml-auto flex flex-wrap items-center gap-2 text-xs">
            <label for="historyPeriodFilter" class="uppercase tracking-wide text-slate-500 dark:text-slate-400">Período</label>
            <select id="historyPeriodFilter" class="input input-sm">
              <option value="7">7 dias</option>
              <option value="30" selected>30 dias</option>
              <option value="90">90 dias</option>
              <option value="365">1 ano</option>
              <option value="all">Todo o período</option>
            </select>
          </div>
          <div id="historyModuleFilterWrap" class="flex flex-wrap items-center gap-2 text-xs hidden">
            <label for="historyModuleFilter" class="uppercase tracking-wide text-slate-500 dark:text-slate-400">Módulo</label>
            <select id="historyModuleFilter" class="input input-sm">
              <option value="all" selected>Todos os módulos</option>
            </select>
          </div>
        </div>
        <div id="historyList" class="grid gap-2 text-sm"></div>
      </div>

      <div class="card card-flat">
        <h3 class="text-lg font-semibold mb-2">Pronto para praticar?</h3>
        <p class="text-sm text-slate-600 dark:text-slate-300">
          Acesse o quiz oficial do módulo e registre seu progresso direto na atividade real.
        </p>
        <button type="button" class="btn btn-primary mt-2" data-nav-target="next-lesson">
          Ir para a próxima atividade
        </button>
      </div>

      <div class="card">
        <h3 class="text-lg font-semibold mb-2">Ranking</h3>
        <div id="rankWrap" class="space-y-2 text-sm"></div>
      </div>

      <!-- Admin -->
      <div id="adminPanel" class="card hidden">
        <h3 class="text-lg font-semibold mb-2">Painel do Administrador</h3>
        <p class="text-sm text-slate-500 mb-2">Ranking consolidado (apenas alunos). Use para premiações.</p>
        <div id="adminRank" class="space-y-2 text-sm"></div>
      </div>
      </div>
    </div>

    <section id="studentSubPageSection" class="space-y-4 hidden">
      <div class="flex flex-wrap items-center justify-between gap-3">
        <div>
          <p class="pill">Explorar</p>
          <h2 class="text-xl font-semibold" id="studentSubPageTitle">Conteúdo complementar</h2>
          <p class="text-sm text-slate-500 dark:text-slate-300" id="studentSubPageSubtitle">
            Escolha uma opção para continuar sua jornada.
          </p>
        </div>
        <button type="button" class="btn btn-ghost" data-nav-target="home">Voltar ao início</button>
      </div>
      <div id="studentSubPageLoading" class="card card-flat text-sm text-slate-500 dark:text-slate-300 hidden">
        Carregando conteúdo...
      </div>
      <div id="studentSubPageError" class="feedback feedback-error hidden"></div>
      <div id="studentSubPageContainer" class="space-y-4"></div>
    </section>
  </section>
  </section>